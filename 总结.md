# 总结
###HttpServletResponse

####设置http响应头控制浏览器禁止缓存当前文档内容

```java
     response.setDateHeader("expries", -1);
     response.setHeader("Cache-Control", "no-cache");
     response.setHeader("Pragma", "no-cache");
```
####设置请求头定时刷新网页

```java
    response.setHeader("refresh","5");
```
####设置请求头实现重定向
一般使用上面这一种,sendRedirect内部的实现原理：使用response设置302状态码和设置location响应头实现重定向
```java
    response.sendRedirect(String location);
```
或者这种方法
这种方法太麻烦了
```java
    response.setStatus(302);
    response.setHeader("location","url")
```
####web工程中URL地址
在JavaWeb开发中，只要是写URL地址，那么建议最好以"/"开头，也就是使用绝对路径的方式，那么这个"/"到底代表什么呢？可以用如下的方式来记忆"/"：`如果"/"是给服务器用的，则代表当前的web工程，如果"/"是给浏览器用的，则代表webapps目录。`
1. 代表当前web工程的应用场景
    1.1 获取资源的绝对路径`ServletContext.getRealPath(String path)`    
    1.2 在服务端转发到其他页面`this.getServletContext().getRequestDispatcher("/index.jsp").forward(request, response);`
    1.3 在jsp中使用`<jsp:include>`标签也如页面
2. 代表webapps的目录应用场景
    2.1 使用`sendRedirect`实现重定向，获取webapp目录的时候最好使用`request.getContextPath()`
    2.2 form表单提交，这时候使用EL表达式，最好是这样`${pageContext.request.contextPath}`

###Cookie进行会话管理
####Cookie
Cookie是客户端技术，程序把每个用户的数据都以cookie的形式给用户各自的浏览器，当用户使用浏览器再去访问服务器中的web资源时，就会带着各自的数据去。这样，web资源处理的就是用户各自的数据了。
####Session
Session是服务端技术，利用这个服务器在运行的时候可以为每一个用户的浏览器创建一个其独享的session对象，由于session为用户浏览器独享，所以用户在访问服务器的web资源时，可以把各自的数据放在各自的session中，当用户再去访问服务器中的其它web资源时，其它web资源再从用户各自的session中取出数据为用户服务。

####Cookie的API

```java
Cookie(String name, String value) 构造方法 创建cookie
	
public String getName() 取得Cookie的名字
public String getValue() 回去cookie的值
public void setValue(String newValue) 设置cookie的值
public void setMaxAge(int expiry)  设置Cookie的最大保存时间，即cookie的有效期，当服务器给浏览器回送一个cookie时，如果在服务器端没有调用setMaxAge方法设置cookie的有效期，那么cookie的有效期只在一次会话过程中有效，用户开一个浏览器，点击多个超链接，访问服务器多个web资源，然后关闭浏览器，整个过程称之为一次会话，当用户关闭浏览器，会话就结束了，此时cookie就会失效，如果在服务器端使用setMaxAge方法设置了cookie的有效期，比如设置了30分钟，那么当服务器把cookie发送给浏览器时，此时cookie就会在客户端的硬盘上存储30分钟，在30分钟内，即使浏览器关了，cookie依然存在，在30分钟内，打开浏览器访问服务器时，浏览器都会把cookie一起带上，这样就可以在服务器端获取到客户端浏览器传递过来的cookie里面的信息了，这就是cookie设置maxAge和不设置maxAge的区别，不设置maxAge，那么cookie就只在一次会话中有效，一旦用户关闭了浏览器，那么cookie就没有了，那么浏览器是怎么做到这一点的呢，我们启动一个浏览器，就相当于启动一个应用程序，而服务器回送的cookie首先是存在浏览器的缓存中的，当浏览器关闭时，浏览器的缓存自然就没有了，所以存储在缓存中的cookie自然就被清掉了，而如果设置了cookie的有效期，那么浏览器在关闭时，就会把缓存中的cookie写到硬盘上存储起来，这样cookie就能够一直存在了。
public int getMaxAge() 获取Cookies的有效期
public void setPath(String uri) 设置cookie的有效路径，比如把cookie的有效路径设置为"/xdp"，那么浏览器访问"xdp"目录下的web资源时，都会带上cookie，再比如把cookie的有效路径设置为"/xdp/gacl"，那么浏览器只有在访问"xdp"目录下的"gacl"这个目录里面的web资源时才会带上cookie一起访问，而当访问"xdp"目录下的web资源时，浏览器是不带cookie的

public String getPath() 获取cookie的有效路径
	
public void setDomain(String pattern)  设置cookie的有效域
public String getDomain() 获取cookie的有效域

```
####Cookie的细节
1. 一个Cookie只能标识一种信息，它至少含有一个标识该信息的名称（NAME）和设置值（VALUE）。
2. 一个WEB站点可以给一个WEB浏览器发送多个Cookie，一个WEB浏览器也可以存储多个WEB站点提供的Cookie。
3. 浏览器一般只允许存放300个Cookie，每个站点最多存放20个Cookie，每个Cookie的大小限制为4KB。
4. 如果创建了一个cookie，并将他发送到浏览器，默认情况下它是一个会话级别的cookie（即存储在浏览器的内存中），用户退出浏览器之后即被删除。若希望浏览器将该cookie存储在磁盘上，则需要使用maxAge，并给出一个以秒为单位的时间。将最大时效设为0则是命令浏览器删除该cookie。

####删除Cookie
setMaxAge的值为0即可
####Cookie中中文处理
必须使用URLEncode先进行转码，不然会抛异常``
获取的时候必须使用URLDecoder.decode(cookies[i].getValue(), "UTF-8")进行解码

```
正常的cookie只能在一个应用中共享，即一个cookie只能由创建它的应用获得。 
1.可在同一应用服务器内共享方法：设置cookie.setPath("/"); 
    本机tomcat/webapp下面有两个应用：cas和webapp_b， 
    1）原来在cas下面设置的cookie，在webapp_b下面获取不到，path默认是产生cookie的应用的路径。 
    2）若在cas下面设置cookie的时候，增加一条cookie.setPath("/");或者cookie.setPath("/webapp_b/");就可以在webapp_b下面获取到cas设置的cookie了。 
    3）此处的参数，是相对于应用服务器存放应用的文件夹的根目录而言的(比如tomcat下面的webapp)，因此cookie.setPath("/");之后，可以在webapp文件夹下的所有应用共享cookie，而cookie.setPath("/webapp_b/");是指cas应用设置的cookie只能在webapp_b应用下的获得，即便是产生这个cookie的cas应用也不可以。 
    4）设置cookie.setPath("/webapp_b/jsp")或者cookie.setPath("/webapp_b/jsp/")的时候，只有在webapp_b/jsp下面可以获得cookie，在webapp_b下面但是在jsp文件夹外的都不能获得cookie。 
    5）设置cookie.setPath("/webapp_b");，是指在webapp_b下面才可以使用cookie，这样就不可以在产生cookie的应用cas下面获取cookie了 
    6）有多条cookie.setPath("XXX");语句的时候，起作用的以最后一条为准。 
    6）设置多个path的方法？？？ 

2.跨域共享cookie的方法：设置cookie.setDomain(".jszx.com"); 
    A机所在的域：home.langchao.com,A有应用cas 
    B机所在的域：jszx.com，B有应用webapp_b 
    1）在cas下面设置cookie的时候，增加cookie.setDomain(".jszx.com");，这样在webapp_b下面就可以取到cookie。 
    2）这个参数必须以“.”开始。 
    3）输入url访问webapp_b的时候，必须输入域名才能解析。比如说在A机器输入：http://lc-bsp.jszx.com:8080/webapp_b,可以获取cas在客户端设置的cookie，而B机器访问本机的应用，输入：http://localhost:8080/webapp_b则不可以获得cookie。 
    4）设置了cookie.setDomain(".jszx.com");，还可以在默认的home.langchao.com下面共享。 
    5）设置多个域的方法？？？
```



